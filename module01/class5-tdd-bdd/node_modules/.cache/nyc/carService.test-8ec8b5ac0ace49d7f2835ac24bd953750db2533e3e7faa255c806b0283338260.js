function cov_2bir9csqa6(){var path="/Users/thiagosaraiva/www/mastering/mastering-node/js-expert/module1/class5-tdd-bdd/test/unitTests/carService.test.js";var hash="cb89ee24c81a051b78003171026d9be373e50cf3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/thiagosaraiva/www/mastering/mastering-node/js-expert/module1/class5-tdd-bdd/test/unitTests/carService.test.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:32}},"1":{start:{line:3,column:19},end:{line:3,column:34}},"2":{start:{line:4,column:56},end:{line:4,column:72}},"3":{start:{line:5,column:14},end:{line:5,column:30}},"4":{start:{line:7,column:19},end:{line:7,column:58}},"5":{start:{line:8,column:20},end:{line:8,column:61}},"6":{start:{line:9,column:21},end:{line:9,column:69}},"7":{start:{line:10,column:14},end:{line:14,column:1}},"8":{start:{line:16,column:0},end:{line:110,column:2}},"9":{start:{line:17,column:19},end:{line:17,column:21}},"10":{start:{line:18,column:16},end:{line:18,column:18}},"11":{start:{line:19,column:2},end:{line:19,column:69}},"12":{start:{line:19,column:16},end:{line:19,column:67}},"13":{start:{line:20,column:2},end:{line:20,column:53}},"14":{start:{line:20,column:20},end:{line:20,column:51}},"15":{start:{line:21,column:2},end:{line:21,column:36}},"16":{start:{line:21,column:18},end:{line:21,column:35}},"17":{start:{line:23,column:2},end:{line:23,column:33}},"18":{start:{line:24,column:2},end:{line:29,column:4}},"19":{start:{line:25,column:17},end:{line:25,column:32}},"20":{start:{line:26,column:19},end:{line:26,column:62}},"21":{start:{line:28,column:4},end:{line:28,column:55}},"22":{start:{line:30,column:2},end:{line:43,column:4}},"23":{start:{line:31,column:24},end:{line:31,column:46}},"24":{start:{line:32,column:21},end:{line:32,column:22}},"25":{start:{line:34,column:4},end:{line:36,column:24}},"26":{start:{line:38,column:19},end:{line:38,column:58}},"27":{start:{line:39,column:21},end:{line:39,column:49}},"28":{start:{line:41,column:4},end:{line:41,column:69}},"29":{start:{line:42,column:4},end:{line:42,column:40}},"30":{start:{line:44,column:2},end:{line:61,column:4}},"31":{start:{line:45,column:16},end:{line:45,column:30}},"32":{start:{line:46,column:24},end:{line:46,column:61}},"33":{start:{line:47,column:4},end:{line:47,column:33}},"34":{start:{line:49,column:4},end:{line:51,column:20}},"35":{start:{line:53,column:4},end:{line:53,column:60}},"36":{start:{line:55,column:19},end:{line:55,column:64}},"37":{start:{line:56,column:21},end:{line:56,column:24}},"38":{start:{line:58,column:4},end:{line:58,column:58}},"39":{start:{line:59,column:4},end:{line:59,column:76}},"40":{start:{line:60,column:4},end:{line:60,column:45}},"41":{start:{line:62,column:2},end:{line:81,column:4}},"42":{start:{line:63,column:21},end:{line:63,column:55}},"43":{start:{line:64,column:4},end:{line:64,column:21}},"44":{start:{line:66,column:24},end:{line:66,column:61}},"45":{start:{line:67,column:4},end:{line:67,column:28}},"46":{start:{line:69,column:25},end:{line:69,column:26}},"47":{start:{line:70,column:4},end:{line:72,column:51}},"48":{start:{line:72,column:17},end:{line:72,column:50}},"49":{start:{line:74,column:21},end:{line:74,column:60}},"50":{start:{line:75,column:19},end:{line:79,column:5}},"51":{start:{line:80,column:4},end:{line:80,column:45}},"52":{start:{line:82,column:2},end:{line:109,column:4}},"53":{start:{line:83,column:16},end:{line:83,column:30}},"54":{start:{line:84,column:24},end:{line:88,column:5}},"55":{start:{line:89,column:21},end:{line:89,column:55}},"56":{start:{line:90,column:4},end:{line:90,column:21}},"57":{start:{line:92,column:25},end:{line:92,column:26}},"58":{start:{line:93,column:20},end:{line:93,column:44}},"59":{start:{line:94,column:16},end:{line:94,column:37}},"60":{start:{line:95,column:4},end:{line:95,column:40}},"61":{start:{line:96,column:4},end:{line:98,column:20}},"62":{start:{line:100,column:27},end:{line:100,column:66}},"63":{start:{line:101,column:21},end:{line:106,column:6}},"64":{start:{line:107,column:19},end:{line:107,column:77}},"65":{start:{line:108,column:4},end:{line:108,column:45}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:34},end:{line:16,column:35}},loc:{start:{line:16,column:40},end:{line:110,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:9},end:{line:19,column:10}},loc:{start:{line:19,column:16},end:{line:19,column:67}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:13},end:{line:20,column:14}},loc:{start:{line:20,column:20},end:{line:20,column:51}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:21,column:12},end:{line:21,column:13}},loc:{start:{line:21,column:18},end:{line:21,column:35}},line:21},"4":{name:"(anonymous_4)",decl:{start:{line:23,column:24},end:{line:23,column:25}},loc:{start:{line:23,column:30},end:{line:23,column:32}},line:23},"5":{name:"(anonymous_5)",decl:{start:{line:24,column:56},end:{line:24,column:57}},loc:{start:{line:24,column:62},end:{line:29,column:3}},line:24},"6":{name:"(anonymous_6)",decl:{start:{line:30,column:62},end:{line:30,column:63}},loc:{start:{line:30,column:68},end:{line:43,column:3}},line:30},"7":{name:"(anonymous_7)",decl:{start:{line:44,column:62},end:{line:44,column:63}},loc:{start:{line:44,column:74},end:{line:61,column:3}},line:44},"8":{name:"(anonymous_8)",decl:{start:{line:62,column:83},end:{line:62,column:84}},loc:{start:{line:62,column:95},end:{line:81,column:3}},line:62},"9":{name:"(anonymous_9)",decl:{start:{line:72,column:11},end:{line:72,column:12}},loc:{start:{line:72,column:17},end:{line:72,column:50}},line:72},"10":{name:"(anonymous_10)",decl:{start:{line:82,column:83},end:{line:82,column:84}},loc:{start:{line:82,column:95},end:{line:109,column:3}},line:82}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cb89ee24c81a051b78003171026d9be373e50cf3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2bir9csqa6=function(){return actualCoverage;};}return actualCoverage;}cov_2bir9csqa6();const{join}=(cov_2bir9csqa6().s[0]++,require("path"));const{expect}=(cov_2bir9csqa6().s[1]++,require("chai"));const{describe,it,before,beforeEach,afterEach}=(cov_2bir9csqa6().s[2]++,require("mocha"));const sinon=(cov_2bir9csqa6().s[3]++,require("sinon"));const CarService=(cov_2bir9csqa6().s[4]++,require("../../src/service/carService"));const Transaction=(cov_2bir9csqa6().s[5]++,require("../../src/entities/transaction"));const carsDatabase=(cov_2bir9csqa6().s[6]++,join(__dirname,"./../../database","cars.json"));const mocks=(cov_2bir9csqa6().s[7]++,{validCarCategory:require("./../mocks/valid-carCategory.json"),validCar:require("./../mocks/valid-car.json"),validCustomer:require("./../mocks/valid-customer.json")});cov_2bir9csqa6().s[8]++;describe("CarService test suite",()=>{cov_2bir9csqa6().f[0]++;let carService=(cov_2bir9csqa6().s[9]++,{});let sandbox=(cov_2bir9csqa6().s[10]++,{});cov_2bir9csqa6().s[11]++;before(()=>{cov_2bir9csqa6().f[1]++;cov_2bir9csqa6().s[12]++;return carService=new CarService({cars:carsDatabase});});cov_2bir9csqa6().s[13]++;beforeEach(()=>{cov_2bir9csqa6().f[2]++;cov_2bir9csqa6().s[14]++;return sandbox=sinon.createSandbox();});cov_2bir9csqa6().s[15]++;afterEach(()=>{cov_2bir9csqa6().f[3]++;cov_2bir9csqa6().s[16]++;return sandbox.restore();});cov_2bir9csqa6().s[17]++;it("structure test ",()=>{cov_2bir9csqa6().f[4]++;});cov_2bir9csqa6().s[18]++;it("should retrieve a random position from an array",()=>{cov_2bir9csqa6().f[5]++;const data=(cov_2bir9csqa6().s[19]++,[0,1,2,3,4]);const result=(cov_2bir9csqa6().s[20]++,carService.getRandomPositionFromArray(data));cov_2bir9csqa6().s[21]++;expect(result).to.be.lte(data.length).and.be.gte(0);});cov_2bir9csqa6().s[22]++;it("should choose the first id from carIds in carCategory",()=>{cov_2bir9csqa6().f[6]++;const carCategory=(cov_2bir9csqa6().s[23]++,mocks.validCarCategory);const carIndex=(cov_2bir9csqa6().s[24]++,0);cov_2bir9csqa6().s[25]++;sandbox.stub(carService,carService.getRandomPositionFromArray.name).returns(carIndex);const result=(cov_2bir9csqa6().s[26]++,carService.chooseRandomCar(carCategory));const expected=(cov_2bir9csqa6().s[27]++,carCategory.carIds[carIndex]);cov_2bir9csqa6().s[28]++;expect(carService.getRandomPositionFromArray.calledOnce).to.be.ok;cov_2bir9csqa6().s[29]++;expect(result).to.be.equal(expected);});cov_2bir9csqa6().s[30]++;it("given a carCategory it should return an available car",async()=>{cov_2bir9csqa6().f[7]++;const car=(cov_2bir9csqa6().s[31]++,mocks.validCar);const carCategory=(cov_2bir9csqa6().s[32]++,Object.create(mocks.validCarCategory));cov_2bir9csqa6().s[33]++;carCategory.carIds=[car.id];cov_2bir9csqa6().s[34]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);cov_2bir9csqa6().s[35]++;sandbox.spy(carService,carService.chooseRandomCar.name);const result=(cov_2bir9csqa6().s[36]++,await carService.getAvaliableCar(carCategory));const expected=(cov_2bir9csqa6().s[37]++,car);cov_2bir9csqa6().s[38]++;expect(carService.chooseRandomCar.calledOnce).to.be.ok;cov_2bir9csqa6().s[39]++;expect(carService.carRepository.find.calledWithExactly(car.id)).to.be.ok;cov_2bir9csqa6().s[40]++;expect(result).to.be.deep.equal(expected);});cov_2bir9csqa6().s[41]++;it("given a customer and a car category it should return a transaction receipt",async()=>{cov_2bir9csqa6().f[8]++;const customer=(cov_2bir9csqa6().s[42]++,Object.create(mocks.validCustomer));cov_2bir9csqa6().s[43]++;customer.age=50;const carCategory=(cov_2bir9csqa6().s[44]++,Object.create(mocks.validCarCategory));cov_2bir9csqa6().s[45]++;carCategory.price=37.6;const numberOfDays=(cov_2bir9csqa6().s[46]++,5);cov_2bir9csqa6().s[47]++;sandbox.stub(carService,"taxesBasedOnAge").get(()=>{cov_2bir9csqa6().f[9]++;cov_2bir9csqa6().s[48]++;return[{from:40,to:50,then:1.3}];});const expected=(cov_2bir9csqa6().s[49]++,carService.currencyFormat.format(244.4));const result=(cov_2bir9csqa6().s[50]++,carService.calculateFinalPrice(customer,carCategory,numberOfDays));cov_2bir9csqa6().s[51]++;expect(result).to.be.deep.equal(expected);});cov_2bir9csqa6().s[52]++;it("given a customer and a car category it should return a transaction receipt",async()=>{cov_2bir9csqa6().f[10]++;const car=(cov_2bir9csqa6().s[53]++,mocks.validCar);const carCategory=(cov_2bir9csqa6().s[54]++,{...mocks.validCarCategory,price:37.6,carIds:[car.id]});const customer=(cov_2bir9csqa6().s[55]++,Object.create(mocks.validCustomer));cov_2bir9csqa6().s[56]++;customer.age=20;const numberOfDays=(cov_2bir9csqa6().s[57]++,5);const dueDate=(cov_2bir9csqa6().s[58]++,"10 de novembro de 2020");const now=(cov_2bir9csqa6().s[59]++,new Date(2020,10,5));cov_2bir9csqa6().s[60]++;sandbox.useFakeTimers(now.getTime());cov_2bir9csqa6().s[61]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);const expectedAmount=(cov_2bir9csqa6().s[62]++,carService.currencyFormat.format(206.8));const expected=(cov_2bir9csqa6().s[63]++,new Transaction({car,dueDate,customer,amount:expectedAmount}));const result=(cov_2bir9csqa6().s[64]++,await carService.rent(customer,carCategory,numberOfDays));cov_2bir9csqa6().s[65]++;expect(result).to.be.deep.equal(expected);});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMmJpcjljc3FhNiIsImFjdHVhbENvdmVyYWdlIiwiam9pbiIsInMiLCJyZXF1aXJlIiwiZXhwZWN0IiwiZGVzY3JpYmUiLCJpdCIsImJlZm9yZSIsImJlZm9yZUVhY2giLCJhZnRlckVhY2giLCJzaW5vbiIsIkNhclNlcnZpY2UiLCJUcmFuc2FjdGlvbiIsImNhcnNEYXRhYmFzZSIsIl9fZGlybmFtZSIsIm1vY2tzIiwidmFsaWRDYXJDYXRlZ29yeSIsInZhbGlkQ2FyIiwidmFsaWRDdXN0b21lciIsImYiLCJjYXJTZXJ2aWNlIiwic2FuZGJveCIsImNhcnMiLCJjcmVhdGVTYW5kYm94IiwicmVzdG9yZSIsImRhdGEiLCJyZXN1bHQiLCJnZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheSIsInRvIiwiYmUiLCJsdGUiLCJsZW5ndGgiLCJhbmQiLCJndGUiLCJjYXJDYXRlZ29yeSIsImNhckluZGV4Iiwic3R1YiIsIm5hbWUiLCJyZXR1cm5zIiwiY2hvb3NlUmFuZG9tQ2FyIiwiZXhwZWN0ZWQiLCJjYXJJZHMiLCJjYWxsZWRPbmNlIiwib2siLCJlcXVhbCIsImNhciIsIk9iamVjdCIsImNyZWF0ZSIsImlkIiwiY2FyUmVwb3NpdG9yeSIsImZpbmQiLCJyZXNvbHZlcyIsInNweSIsImdldEF2YWxpYWJsZUNhciIsImNhbGxlZFdpdGhFeGFjdGx5IiwiZGVlcCIsImN1c3RvbWVyIiwiYWdlIiwicHJpY2UiLCJudW1iZXJPZkRheXMiLCJnZXQiLCJmcm9tIiwidGhlbiIsImN1cnJlbmN5Rm9ybWF0IiwiZm9ybWF0IiwiY2FsY3VsYXRlRmluYWxQcmljZSIsImR1ZURhdGUiLCJub3ciLCJEYXRlIiwidXNlRmFrZVRpbWVycyIsImdldFRpbWUiLCJleHBlY3RlZEFtb3VudCIsImFtb3VudCIsInJlbnQiXSwic291cmNlcyI6WyJjYXJTZXJ2aWNlLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBqb2luIH0gPSByZXF1aXJlKFwicGF0aFwiKVxuXG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZShcImNoYWlcIilcbmNvbnN0IHsgZGVzY3JpYmUsIGl0LCBiZWZvcmUsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCB9ID0gcmVxdWlyZShcIm1vY2hhXCIpXG5jb25zdCBzaW5vbiA9IHJlcXVpcmUoXCJzaW5vblwiKVxuXG5jb25zdCBDYXJTZXJ2aWNlID0gcmVxdWlyZShcIi4uLy4uL3NyYy9zZXJ2aWNlL2NhclNlcnZpY2VcIilcbmNvbnN0IFRyYW5zYWN0aW9uID0gcmVxdWlyZShcIi4uLy4uL3NyYy9lbnRpdGllcy90cmFuc2FjdGlvblwiKVxuY29uc3QgY2Fyc0RhdGFiYXNlID0gam9pbihfX2Rpcm5hbWUsIFwiLi8uLi8uLi9kYXRhYmFzZVwiLCBcImNhcnMuanNvblwiKVxuY29uc3QgbW9ja3MgPSB7XG4gIHZhbGlkQ2FyQ2F0ZWdvcnk6IHJlcXVpcmUoXCIuLy4uL21vY2tzL3ZhbGlkLWNhckNhdGVnb3J5Lmpzb25cIiksXG4gIHZhbGlkQ2FyOiByZXF1aXJlKFwiLi8uLi9tb2Nrcy92YWxpZC1jYXIuanNvblwiKSxcbiAgdmFsaWRDdXN0b21lcjogcmVxdWlyZShcIi4vLi4vbW9ja3MvdmFsaWQtY3VzdG9tZXIuanNvblwiKSxcbn1cblxuZGVzY3JpYmUoXCJDYXJTZXJ2aWNlIHRlc3Qgc3VpdGVcIiwgKCkgPT4ge1xuICBsZXQgY2FyU2VydmljZSA9IHt9XG4gIGxldCBzYW5kYm94ID0ge31cbiAgYmVmb3JlKCgpID0+IChjYXJTZXJ2aWNlID0gbmV3IENhclNlcnZpY2UoeyBjYXJzOiBjYXJzRGF0YWJhc2UgfSkpKVxuICBiZWZvcmVFYWNoKCgpID0+IChzYW5kYm94ID0gc2lub24uY3JlYXRlU2FuZGJveCgpKSlcbiAgYWZ0ZXJFYWNoKCgpID0+IHNhbmRib3gucmVzdG9yZSgpKVxuXG4gIGl0KFwic3RydWN0dXJlIHRlc3QgXCIsICgpID0+IHt9KVxuICBpdChcInNob3VsZCByZXRyaWV2ZSBhIHJhbmRvbSBwb3NpdGlvbiBmcm9tIGFuIGFycmF5XCIsICgpID0+IHtcbiAgICBjb25zdCBkYXRhID0gWzAsIDEsIDIsIDMsIDRdXG4gICAgY29uc3QgcmVzdWx0ID0gY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheShkYXRhKVxuXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUubHRlKGRhdGEubGVuZ3RoKS5hbmQuYmUuZ3RlKDApXG4gIH0pXG4gIGl0KFwic2hvdWxkIGNob29zZSB0aGUgZmlyc3QgaWQgZnJvbSBjYXJJZHMgaW4gY2FyQ2F0ZWdvcnlcIiwgKCkgPT4ge1xuICAgIGNvbnN0IGNhckNhdGVnb3J5ID0gbW9ja3MudmFsaWRDYXJDYXRlZ29yeVxuICAgIGNvbnN0IGNhckluZGV4ID0gMFxuXG4gICAgc2FuZGJveFxuICAgICAgLnN0dWIoY2FyU2VydmljZSwgY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheS5uYW1lKVxuICAgICAgLnJldHVybnMoY2FySW5kZXgpXG5cbiAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhcihjYXJDYXRlZ29yeSlcbiAgICBjb25zdCBleHBlY3RlZCA9IGNhckNhdGVnb3J5LmNhcklkc1tjYXJJbmRleF1cblxuICAgIGV4cGVjdChjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5LmNhbGxlZE9uY2UpLnRvLmJlLm9rXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZXF1YWwoZXhwZWN0ZWQpXG4gIH0pXG4gIGl0KFwiZ2l2ZW4gYSBjYXJDYXRlZ29yeSBpdCBzaG91bGQgcmV0dXJuIGFuIGF2YWlsYWJsZSBjYXJcIiwgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNhciA9IG1vY2tzLnZhbGlkQ2FyXG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpXG4gICAgY2FyQ2F0ZWdvcnkuY2FySWRzID0gW2Nhci5pZF1cblxuICAgIHNhbmRib3hcbiAgICAgIC5zdHViKGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeSwgY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LmZpbmQubmFtZSlcbiAgICAgIC5yZXNvbHZlcyhjYXIpXG5cbiAgICBzYW5kYm94LnNweShjYXJTZXJ2aWNlLCBjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhci5uYW1lKVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FyU2VydmljZS5nZXRBdmFsaWFibGVDYXIoY2FyQ2F0ZWdvcnkpXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJcblxuICAgIGV4cGVjdChjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhci5jYWxsZWRPbmNlKS50by5iZS5va1xuICAgIGV4cGVjdChjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnkuZmluZC5jYWxsZWRXaXRoRXhhY3RseShjYXIuaWQpKS50by5iZS5va1xuICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmRlZXAuZXF1YWwoZXhwZWN0ZWQpXG4gIH0pXG4gIGl0KFwiZ2l2ZW4gYSBjdXN0b21lciBhbmQgYSBjYXIgY2F0ZWdvcnkgaXQgc2hvdWxkIHJldHVybiBhIHRyYW5zYWN0aW9uIHJlY2VpcHRcIiwgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGN1c3RvbWVyID0gT2JqZWN0LmNyZWF0ZShtb2Nrcy52YWxpZEN1c3RvbWVyKVxuICAgIGN1c3RvbWVyLmFnZSA9IDUwXG5cbiAgICBjb25zdCBjYXJDYXRlZ29yeSA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDYXJDYXRlZ29yeSlcbiAgICBjYXJDYXRlZ29yeS5wcmljZSA9IDM3LjZcblxuICAgIGNvbnN0IG51bWJlck9mRGF5cyA9IDVcbiAgICBzYW5kYm94XG4gICAgICAuc3R1YihjYXJTZXJ2aWNlLCBcInRheGVzQmFzZWRPbkFnZVwiKVxuICAgICAgLmdldCgoKSA9PiBbeyBmcm9tOiA0MCwgdG86IDUwLCB0aGVuOiAxLjMgfV0pXG5cbiAgICBjb25zdCBleHBlY3RlZCA9IGNhclNlcnZpY2UuY3VycmVuY3lGb3JtYXQuZm9ybWF0KDI0NC40KVxuICAgIGNvbnN0IHJlc3VsdCA9IGNhclNlcnZpY2UuY2FsY3VsYXRlRmluYWxQcmljZShcbiAgICAgIGN1c3RvbWVyLFxuICAgICAgY2FyQ2F0ZWdvcnksXG4gICAgICBudW1iZXJPZkRheXNcbiAgICApXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZClcbiAgfSlcbiAgaXQoXCJnaXZlbiBhIGN1c3RvbWVyIGFuZCBhIGNhciBjYXRlZ29yeSBpdCBzaG91bGQgcmV0dXJuIGEgdHJhbnNhY3Rpb24gcmVjZWlwdFwiLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgY2FyID0gbW9ja3MudmFsaWRDYXJcbiAgICBjb25zdCBjYXJDYXRlZ29yeSA9IHtcbiAgICAgIC4uLm1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnksXG4gICAgICBwcmljZTogMzcuNixcbiAgICAgIGNhcklkczogW2Nhci5pZF0sXG4gICAgfVxuICAgIGNvbnN0IGN1c3RvbWVyID0gT2JqZWN0LmNyZWF0ZShtb2Nrcy52YWxpZEN1c3RvbWVyKVxuICAgIGN1c3RvbWVyLmFnZSA9IDIwXG5cbiAgICBjb25zdCBudW1iZXJPZkRheXMgPSA1XG4gICAgY29uc3QgZHVlRGF0ZSA9IFwiMTAgZGUgbm92ZW1icm8gZGUgMjAyMFwiXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoMjAyMCwgMTAsIDUpXG4gICAgc2FuZGJveC51c2VGYWtlVGltZXJzKG5vdy5nZXRUaW1lKCkpXG4gICAgc2FuZGJveFxuICAgICAgLnN0dWIoY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LCBjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnkuZmluZC5uYW1lKVxuICAgICAgLnJlc29sdmVzKGNhcilcblxuICAgIGNvbnN0IGV4cGVjdGVkQW1vdW50ID0gY2FyU2VydmljZS5jdXJyZW5jeUZvcm1hdC5mb3JtYXQoMjA2LjgpXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBuZXcgVHJhbnNhY3Rpb24oe1xuICAgICAgY2FyLFxuICAgICAgZHVlRGF0ZSxcbiAgICAgIGN1c3RvbWVyLFxuICAgICAgYW1vdW50OiBleHBlY3RlZEFtb3VudCxcbiAgICB9KVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhclNlcnZpY2UucmVudChjdXN0b21lciwgY2FyQ2F0ZWdvcnksIG51bWJlck9mRGF5cylcbiAgICBleHBlY3QocmVzdWx0KS50by5iZS5kZWVwLmVxdWFsKGV4cGVjdGVkKVxuICB9KVxufSlcbiJdLCJtYXBwaW5ncyI6Ims3TUFlWTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FmWixLQUFNLENBQUVFLElBQUssQ0FBQyxFQUFBRixjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUVoQyxLQUFNLENBQUVDLE1BQU8sQ0FBQyxFQUFBTCxjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUNsQyxLQUFNLENBQUVFLFFBQVEsQ0FBRUMsRUFBRSxDQUFFQyxNQUFNLENBQUVDLFVBQVUsQ0FBRUMsU0FBVSxDQUFDLEVBQUFWLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQ3hFLEtBQU0sQ0FBQU8sS0FBSyxFQUFBWCxjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUU5QixLQUFNLENBQUFRLFVBQVUsRUFBQVosY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQyxFQUMxRCxLQUFNLENBQUFTLFdBQVcsRUFBQWIsY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxnQ0FBZ0MsQ0FBQyxFQUM3RCxLQUFNLENBQUFVLFlBQVksRUFBQWQsY0FBQSxHQUFBRyxDQUFBLE1BQUdELElBQUksQ0FBQ2EsU0FBUyxDQUFFLGtCQUFrQixDQUFFLFdBQVcsQ0FBQyxFQUNyRSxLQUFNLENBQUFDLEtBQUssRUFBQWhCLGNB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